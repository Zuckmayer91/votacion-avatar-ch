<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infograf√≠a: Estrategia de Avatares 3D - Asesor√≠as y Parcelaciones CH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 300px;
            width: 100%;
            max-width: 450px;
        }
        .text-shadow-custom {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .flow-step {
            border: 2px solid #118AB2;
            background-color: #ffffff;
            color: #073B4C;
        }
        .flow-arrow {
            color: #118AB2;
            font-size: 2rem;
            line-height: 1;
        }
        /* Estilos para la nueva secci√≥n de votaci√≥n */
        .avatar-vote-option {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .avatar-vote-option.selected {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(17, 138, 178, 0.7);
            border-color: #118AB2;
        }
        #vote-results {
            display: none; /* Oculto hasta que se vote */
        }
    </style>
</head>
<body class="text-[#073B4C]">

    <main class="container mx-auto p-4 md:p-8">

        <header class="text-center py-12 bg-white rounded-2xl shadow-lg mb-12" style="background-image: linear-gradient(rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.95)), url('https://placehold.co/1200x400/118AB2/FFFFFF?text=A&P+CH'); background-size: cover; background-position: center;">
            <div class="flex justify-center mb-6">
                <img src="https://ftyatux.stripocdn.email/content/guids/CABINET_50652b5a354224171e7e83e2fd8ffd668257837623729cd52dd9400f741cdab2/images/upscalemediatransformedremovebgpreview.png"
                     alt="Logo Asesor√≠as y Parcelaciones CH"
                     class="w-40 h-auto md:w-52 object-contain">
            </div>
            <h1 class="text-4xl md:text-6xl font-black uppercase text-[#073B4C] text-shadow-custom">Avatar</h1>
            <p class="text-xl md:text-2xl mt-4 font-semibold text-[#118AB2]">
                Humanizando la Inversi√≥n Inmobiliaria en Asesor√≠as y Parcelaciones CH
            </p>
        </header>

        <section id="cuestionario-votacion" class="mb-16 px-8 py-12 bg-white shadow-xl border border-gray-200 rounded-2xl">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-extrabold text-gray-800">üó≥Ô∏è ¬°Tu Voto Cuenta!</h2>
                <p class="max-w-4xl mx-auto mt-4 text-lg text-gray-600">
                    Ay√∫danos a decidir qu√© personaje representar√° mejor a Asesor√≠as y Parcelaciones CH. Elige el avatar que creas que conecta mejor con nuestros valores y clientes.
                </p>
            </div>

            <div class="flex flex-col md:flex-row justify-center items-center gap-10">
                <div id="avatar1" class="avatar-vote-option text-center p-4 border-4 border-transparent rounded-xl" onclick="selectAvatar('avatar1')">
                    <div class="w-64 h-64 overflow-hidden rounded-xl shadow-lg mx-auto">
                        <img src="https://ftyatux.stripocdn.email/content/guids/CABINET_8a2fd8b8a39fbfd2a85f337a9460f5bcc87095c6a6276ff38017a2e4436ae397/images/gemini_generated_image_eahsboeahsboeahs_0Y4.jpg"
                             alt="Avatar Opci√≥n 1"
                             class="w-full h-full object-cover">
                    </div>
                    <h3 class="mt-4 text-2xl font-bold">Avatar 1</h3>
                </div>

                <div id="avatar2" class="avatar-vote-option text-center p-4 border-4 border-transparent rounded-xl" onclick="selectAvatar('avatar2')">
                    <div class="w-64 h-64 overflow-hidden rounded-xl shadow-lg mx-auto">
                        <img src="https://ftyatux.stripocdn.email/content/guids/CABINET_8a2fd8b8a39fbfd2a85f337a9460f5bcc87095c6a6276ff38017a2e4436ae397/images/gemini_generated_image_64jg6c64jg6c64jg.jpg"
                             alt="Avatar Opci√≥n 2"
                             class="w-full h-full object-cover">
                    </div>
                    <h3 class="mt-4 text-2xl font-bold">Avatar 2</h3>
                </div>
            </div>

            <div class="text-center mt-10">
                <button id="vote-button" class="bg-[#FF6B6B] text-white font-bold py-3 px-8 rounded-lg text-xl shadow-lg hover:bg-[#ff4f4f] transition-colors disabled:bg-gray-400" onclick="submitVote()" disabled>
                    Votar
                </button>
            </div>

            <div id="vote-results" class="mt-10 max-w-2xl mx-auto">
                 <h3 class="text-2xl font-bold text-center mb-4">Resultados</h3>
                 <div class="w-full bg-gray-200 rounded-full h-8 dark:bg-gray-700 overflow-hidden">
                     <div id="results-bar-1" class="bg-[#118AB2] h-8 text-xs font-medium text-blue-100 text-center p-2 leading-none" style="width: 50%">Avatar 1: 50%</div>
                     <div id="results-bar-2" class="bg-[#06D6A0] h-8 text-xs font-medium text-green-100 text-center p-2 leading-none" style="width: 50%">Avatar 2: 50%</div>
                 </div>
                 <p id="winner-message" class="text-center mt-4 font-semibold text-lg"></p>
            </div>
        </section>
        <section id="strategy" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold">La Estrategia Detr√°s del Estilo</h2>
                <p class="max-w-3xl mx-auto mt-2 text-lg">Se eligi√≥ un enfoque Cartoon 3D para equilibrar profesionalismo y cercan√≠a, conectando emocionalmente con nuestros inversionistas.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <div class="bg-white p-8 rounded-lg shadow-md">
                    <div class="text-6xl mb-4 text-[#FF6B6B]">ü§ù</div>
                    <h3 class="text-2xl font-bold mb-2">Amigable y Accesible</h3>
                    <p>Genera una conexi√≥n emocional inmediata, haciendo la marca m√°s cercana y f√°cil de abordar.</p>
                </div>
                <div class="bg-white p-8 rounded-lg shadow-md">
                    <div class="text-6xl mb-4 text-[#FFD166]">üëî</div>
                    <h3 class="text-2xl font-bold mb-2">Profesional y Moderno</h3>
                    <p>El detalle del 3D transmite alta calidad y confianza, asegurando una percepci√≥n de seriedad y vanguardia.</p>
                </div>
                <div class="bg-white p-8 rounded-lg shadow-md">
                    <div class="text-6xl mb-4 text-[#06D6A0]">üîÑ</div>
                    <h3 class="text-2xl font-bold mb-2">Visualmente Vers√°til</h3>
                    <p>Adaptable a cualquier formato, desde im√°genes est√°ticas hasta animaciones complejas para videos y Reels.</p>
                </div>
            </div>
        </section>

        <section id="inclusivity" class="mb-16 px-8 py-12 bg-white shadow-xl border border-gray-200 rounded-2xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-extrabold text-gray-800">Dos Versiones, Una Misi√≥n: La Inclusi√≥n</h2>
                <p class="max-w-4xl mx-auto mt-4 text-lg text-gray-600">
                    Para reflejar la diversidad de Colombia y asegurar que m√°s personas se sientan representadas, cree dos versiones base del avatar.
                </p>
            </div>
            <div class="flex flex-col md:flex-row justify-center items-center gap-12">
                <div class="w-72 h-72 overflow-hidden border-4 border-[#118AB2] rounded-xl shadow-lg">
                    <img src="https://ftyatux.stripocdn.email/content/guids/CABINET_8a2fd8b8a39fbfd2a85f337a9460f5bcc87095c6a6276ff38017a2e4436ae397/images/gemini_generated_image_eahsboeahsboeahs_0Y4.jpg"
                         alt="Avatar de piel clara"
                         class="w-full h-full object-cover">
                </div>
                <div class="text-6xl font-black text-[#FF6B6B] select-none">+</div>
                <div class="w-72 h-72 overflow-hidden border-4 border-[#06D6A0] rounded-xl shadow-lg">
                    <img src="https://ftyatux.stripocdn.email/content/guids/CABINET_8a2fd8b8a39fbfd2a85f337a9460f5bcc87095c6a6276ff38017a2e4436ae397/images/gemini_generated_image_64jg6c64jg6c64jg.jpg"
                         alt="Avatar de piel canela"
                         class="w-full h-full object-cover">
                </div>
            </div>
        </section>

        <section id="roles" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold">Las Cuatro Caras de la Asesor√≠a Experta</h2>
                <p class="max-w-3xl mx-auto mt-2 text-lg">Cada pose del avatar est√° dise√±ada para comunicar un mensaje espec√≠fico en el momento adecuado del viaje del cliente.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-center mb-4">El Asesor Moderno</h3>
                    <p class="text-center mb-4">Comunica experiencia, conocimiento t√©cnico y planificaci√≥n. Es el experto con todos los detalles bajo control.</p>
                    <div class="chart-container"><canvas id="asesorModernoChart"></canvas></div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-center mb-4">El Profesional Explicativo</h3>
                    <p class="text-center mb-4">Transmite claridad, transparencia y disposici√≥n para guiar. Simplifica lo complejo.</p>
                    <div class="chart-container"><canvas id="profesionalExplicativoChart"></canvas></div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-center mb-4">El Saludo Confiable</h3>
                    <p class="text-center mb-4">Genera cercan√≠a, confianza y accesibilidad. Es la bienvenida a una conversaci√≥n.</p>
                    <div class="chart-container"><canvas id="saludoConfiableChart"></canvas></div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-center mb-4">El Experto Apasionado</h3>
                    <p class="text-center mb-4">Proyecta entusiasmo, √©xito y motivaci√≥n para la acci√≥n. Celebra los logros contigo.</p>
                    <div class="chart-container"><canvas id="expertoApasionadoChart"></canvas></div>
                </div>
            </div>
        </section>

        <section id="applications" class="mb-12 p-8 bg-white rounded-lg shadow-md">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold">Aplicaciones Pr√°cticas en el Marketing Digital</h2>
                <p class="max-w-3xl mx-auto mt-2 text-lg">El avatar se integra de forma nativa en el embudo de comunicaci√≥n para guiar al cliente en cada etapa.</p>
            </div>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                <div class="flow-step p-4 rounded-lg text-center shadow">
                    <h4 class="font-bold">1. Redes Sociales</h4>
                    <p>(Saludo Confiable)</p>
                </div>
                <div class="flow-arrow font-bold transform md:-translate-y-4 md:rotate-0 rotate-90">‚Üí</div>
                <div class="flow-step p-4 rounded-lg text-center shadow">
                    <h4 class="font-bold">2. Carrusel/Video</h4>
                    <p>(Profesional Explicativo)</p>
                </div>
                <div class="flow-arrow font-bold transform md:-translate-y-4 md:rotate-0 rotate-90">‚Üí</div>
                <div class="flow-step p-4 rounded-lg text-center shadow">
                    <h4 class="font-bold">3. P√°gina Web/Anuncio</h4>
                    <p>(Asesor Moderno)</p>
                </div>
                <div class="flow-arrow font-bold transform md:-translate-y-4 md:rotate-0 rotate-90">‚Üí</div>
                <div class="flow-step p-4 rounded-lg text-center shadow bg-[#FF6B6B] text-white">
                    <h4 class="font-bold">4. Llamado a la Acci√≥n</h4>
                    <p>(Experto Apasionado)</p>
                </div>
            </div>
        </section>

        <section id="value" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold">El Valor Agregado a la Estrategia</h2>
                <p class="max-w-3xl mx-auto mt-2 text-lg">El avatar es un activo de marca que genera resultados medibles.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <h3 class="text-xl font-bold mb-2">Humaniza la Marca</h3>
                    <div class="chart-container h-56"><canvas id="humanizaChart"></canvas></div>
                    <p class="mt-4">Fortalece la conexi√≥n emocional con el cliente.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <h3 class="text-xl font-bold mb-2">Diferenciaci√≥n Clave</h3>
                    <div class="chart-container h-56"><canvas id="diferenciaChart"></canvas></div>
                    <p class="mt-4">Destaca de la competencia con una identidad visual moderna.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <h3 class="text-xl font-bold mb-2">Aumenta Recuerdo</h3>
                    <div class="chart-container h-56"><canvas id="recuerdoChart"></canvas></div>
                    <p class="mt-4">Proporciona un rostro consistente y memorable.</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-6 bg-[#073B4C] text-white">
        <p>&copy; 2025 Asesor√≠as y Parcelaciones CH. Todos los derechos reservados.</p>
    </footer>

    <script type="module">
      // Importar las funciones necesarias de los SDK
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
      import { getFirestore, doc, onSnapshot, runTransaction, increment, setDoc } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

      // Tu configuraci√≥n de Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyDx8mCis6YU201Y076dmpeOlqjtCz4Abdc", // ¬°OJO! No expongas claves reales en repositorios p√∫blicos si la seguridad es cr√≠tica.
        authDomain: "votacion-avatar-ch.firebaseapp.com",
        projectId: "votacion-avatar-ch",
        storageBucket: "votacion-avatar-ch.firebasestorage.app",
        messagingSenderId: "597103740242",
        appId: "1:597103740242:web:db9e80080ad019c8cc668b",
        measurementId: "G-L9K00H5VNT"
      };

      // Inicializar Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const voteDocRef = doc(db, "votacion", "resultados");

      // --- L√ìGICA DE VOTACI√ìN ---
      let selectedAvatarId = null;
      let userHasVoted = false;

      // Asignar eventos a los elementos
      document.getElementById('avatar1').addEventListener('click', () => selectAvatar('avatar1'));
      document.getElementById('avatar2').addEventListener('click', () => selectAvatar('avatar2'));
      document.getElementById('vote-button').addEventListener('click', submitVote);

      // Escuchar cambios en la base de datos en tiempo real
      onSnapshot(voteDocRef, (doc) => {
        if (doc.exists()) {
            const votes = doc.data();
            updateResultsUI(votes.avatar1, votes.avatar2);
        } else {
            // Si el documento no existe, lo creamos
            setDoc(voteDocRef, { avatar1: 0, avatar2: 0 });
        }
      });

      function selectAvatar(avatarId) {
        if (userHasVoted) return; // Si ya vot√≥, no hacer nada

        document.querySelectorAll('.avatar-vote-option').forEach(el => el.classList.remove('selected'));
        document.getElementById(avatarId).classList.add('selected');
        selectedAvatarId = avatarId;
        document.getElementById('vote-button').disabled = false;
      }

      async function submitVote() {
        if (!selectedAvatarId || userHasVoted) return;
        userHasVoted = true;

        try {
            await runTransaction(db, async (transaction) => {
                const updateData = {};
                updateData[selectedAvatarId] = increment(1); // Incremento at√≥mico
                transaction.update(voteDocRef, updateData);
            });
            console.log("Voto registrado con √©xito!");
            disableVotingInterface();
        } catch (e) {
            console.error("Error al registrar el voto: ", e);
        }
      }
      
      function disableVotingInterface() {
        const voteButton = document.getElementById('vote-button');
        voteButton.disabled = true;
        voteButton.textContent = '¬°Gracias por votar!';
        
        document.querySelectorAll('.avatar-vote-option').forEach(el => {
            el.style.cursor = 'default';
            if (!el.classList.contains('selected')) {
                el.style.opacity = '0.6';
            }
        });
      }

      function updateResultsUI(votes1 = 0, votes2 = 0) {
        const totalVotes = votes1 + votes2;
        let percentage1 = 0; // Inicia el porcentaje en 0
        let percentage2 = 0; // Inicia el porcentaje en 0

        // Solo calcula porcentajes si hay votos
        if (totalVotes > 0) {
          percentage1 = (votes1 / totalVotes) * 100;
          percentage2 = (votes2 / totalVotes) * 100;
        }

        const resultsBar1 = document.getElementById('results-bar-1');
        const resultsBar2 = document.getElementById('results-bar-2');
        const winnerMessage = document.getElementById('winner-message');

        // Actualiza el ancho de las barras
        // Muestra el n√∫mero de votos y el porcentaje
        resultsBar1.textContent = votes1 > 0 ? `${votes1} ${votes1 === 1 ? 'voto' : 'votos'} (${percentage1.toFixed(1)}%)` : '';
        resultsBar2.textContent = votes2 > 0 ? `${votes2} ${votes2 === 1 ? 'voto' : 'votos'} (${percentage2.toFixed(1)}%)` : '';

        // Muestra el texto del porcentaje solo si es mayor a cero
        resultsBar1.textContent = percentage1 > 0 ? `${percentage1.toFixed(1)}%` : '';
        resultsBar2.textContent = percentage2 > 0 ? `${percentage2.toFixed(1)}%` : '';

        // Actualiza el mensaje inferior seg√∫n el estado de la votaci√≥n
        if (totalVotes === 0) {
          winnerMessage.textContent = 'S√© el primero en votar.';
          winnerMessage.style.color = '#6B7280'; // Un color gris neutral
        } else if (votes1 > votes2) {
          winnerMessage.textContent = `El Avatar 1 va ganando con ${votes1} votos.`;
          winnerMessage.style.color = '#118AB2';
        } else if (votes2 > votes1) {
          winnerMessage.textContent = `El Avatar 2 va a la delantera con ${votes2} votos.`;
          winnerMessage.style.color = '#06D6A0';
        } else {
          winnerMessage.textContent = `¬°La votaci√≥n est√° empatada con ${votes1} votos cada uno!`;
          winnerMessage.style.color = '#073B4C';
        }

        document.getElementById('vote-results').style.display = 'block';
      }

      // --- C√ìDIGO PARA LAS GR√ÅFICAS DE LA INFOGRAF√çA ---

            const tooltipConfig = {
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) {
                                    return label.join(' ');
                                }
                                return label;
                            }
                        }
                    }
                }
            };

            const chartColors = ['#118AB2', '#06D6A0', '#FFD166', '#FF6B6B'];

            const createBarChart = (ctx, labels, data) => {
                // Busca el canvas usando el ID que le pasas
                const canvasElement = document.getElementById(ctx);
                if (!canvasElement) return; // Si no lo encuentra, no hace nada

                new Chart(canvasElement, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Nivel de Comunicaci√≥n',
                            data: data,
                            backgroundColor: chartColors,
                            borderColor: chartColors.map(c => c + 'B3'),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        ...tooltipConfig,
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { color: '#073B4C' }
                            },
                            y: {
                                ticks: {
                                    color: '#073B4C',
                                    font: { weight: 'bold' }
                                }
                            }
                        },
                        plugins: {
                            ...tooltipConfig.plugins,
                            legend: { display: false }
                        }
                    }
                });
            };

            // Llamadas para crear cada una de las gr√°ficas
            createBarChart('asesorModernoChart', ['Experiencia', 'Planificaci√≥n', 'Seguridad'], [95, 90, 85]);
            createBarChart('profesionalExplicativoChart', ['Claridad', 'Transparencia', 'Gu√≠a'], [90, 95, 80]);
            createBarChart('saludoConfiableChart', ['Confianza', 'Cercan√≠a', 'Accesibilidad'], [95, 92, 88]);
            createBarChart('expertoApasionadoChart', ['Motivaci√≥n', 'Entusiasmo', '√âxito'], [90, 95, 85]);


            // --- C√ìDIGO PARA LAS GR√ÅFICAS DE DONA ---

            const createDonutChart = (ctx, label, data) => {
                const canvasElement = document.getElementById(ctx);
                if (!canvasElement) return;

                new Chart(canvasElement, {
                    type: 'doughnut',
                    data: {
                        labels: [label, ''],
                        datasets: [{
                            data: [data, 100 - data],
                            backgroundColor: [chartColors[Math.floor(Math.random() * chartColors.length)], '#E5E7EB'],
                            borderWidth: 0,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '70%',
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false }
                        }
                    }
                });
            };

            // Llamadas para crear cada una de las gr√°ficas de dona
            createDonutChart('humanizaChart', 'Conexi√≥n Emocional', 75);
            createDonutChart('diferenciaChart', 'Diferenciaci√≥n', 85);
            createDonutChart('recuerdoChart', 'Recuerdo de Marca', 80);
    </script>
</body>
</html>
</body>
</html>